/*                                              
                                                                                                    
                                             `,;'@@@';,                                             
                                        '@@@@@@@@@@@@@@@@@@@:                                       
                                    :@@@@@@@@@@@@@@@@@@@@@@@@@@@`                                   
                                 .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                                 
                               +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                              
                             #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                            
                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`                          
                          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                         
                        @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                       
                       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                      
                     ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     
                    +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`                   
                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                  
                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:                 
                 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:                
                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.               
               +@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               
              ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              
              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@             
             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#            
            #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`           
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;@@@+++@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
           @@@@@@@@@@@@@@@@@@@@@@@@`:@@+  @   :   ,#     :  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@#          
          ;@@@@@@@@@@@@@@@@@@@@@@@'  ;; `      ,@    @@@    @#+@@@@@@@@@@@@@@@@@@@@@@@@@@@          
          @@@@@@@@@@@@@@@@@@@@@@@@     `@  @   @.  `@@#  @@     ,@@@@@@@@@@@@@@@@@@@@@@@@@@         
         +@@@@@@@@@@@@@@@@@@@@@@@# @   @+  @  :@@  #@@  @@@  .     `@@@@@@@@@@@@@@@@@@@@@@@         
         @@@@@@@@@@@@@@@@@@@@@@@@` @  +@@ #@  @@. @@@  @@@  @@   @    #@@@@@@@@@@@@@@@@@@@@@        
        '@@@@@@@@@@@@@@@@@@@@@; ' .@  @@  @@'@@+ ,@@  @@#  @+  '@  .@   @@@@@@@@@@@@@@@@@@@@        
        @@@@@@@@@@@@@@@@@@@@@@+   @@#:@@ #@@@@@  @@  @@'  @`  @,  #@@     @@@@@@@@@@@@@@@@@@@       
       ,@@@@@@@@@@@@@@@@@@@@@@'   @@@@@  @@@@@  @@` #@.  @  :+    @.       `@@@@@@@@@@@@@@@@@       
       @@@@@@@@@@@@@@@@@@@@@@@;   @@@@@@@@@@@@ @@@ :@` ,@  +@          .@    @@@@@@@@@@@@@@@@:      
       @@@@@@@@@@@@@@@@@@@@@@           ,,,'@@@@+@@@@@#@# ;@  ;@      @   '@  @@@@@@@@@@@@@@@@      
      :@@@@@@@@@@@@@@@@@@@@                         `@@@@@@  @@     :@@ ,#    ,@@@@@@@@@@@@@@@      
      @@@@@@@@@@@@@@@@@@@                                 ##@+  #  ;@@@'   @,  +@@@@@@@@@@@@@@:     
      @@@@@@@@@@@@@@@@@                                     @@ @  ,@ ;   @@@    @@@@@@@@@@@@@@@     
      @@@@@@@@@@@@@@@                                         @@'      @@@@     @@@@@@@@@@@@@@@     
     '@@@@@@@@@@@@@:            ``::::````                      @+    @@@;      @@@@@@@@@@;@@@@     
     @@@@@@@@@@@@@             @@@@@@@@@@@@@@@@@#,               ,   :@.     ,` @@@@@@@@    @@@,    
     @@@@@@@@@@@;             @@@@@@@@@@@@@@@@@@@@@@'                `   @@@    @@@@@;    @  @@#    
     @@@@@@@@@@               @@@@@@@@@@@@@@@@@@@@@@@@@`               +@@@@    @@@`  `@@@#:  @@    
     @@@@@@@@;                @@@@@@@@@@@@@@@@@@@@@@@@@@@;            +@@@@@   '@   `@@;       @    
    `@@@@@@@                  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@,          `@, .#      :@@,   +@@@# @    
    ,@@@@@;                   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.         @@        @@@@@@@@+.    .    
    ;@@@'                     `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@        @@`        +:        `@`     
    +`                         @@@@@@@@#`  @@@@@@@@@@@@@@@@@@@@@#      @@@            .#@@@@+;@     
    @                          @@@@`        @@@@@@@@@@@@@@@@@@@@@@     @@@         @@@@@@@@@:@@     
    +'                        `@@,           @@@@@@@@@@@@@@@@@@@@@@    @@@                    @     
                              ;    ,;@#,   .  @@@@@@@@@@@@@@@@@@@@@@   @@@          ,,,,:'++@@@     
    ,                        @@@,  @@@@+;@@@@ +@@@@@@@@@@@@@@@@@@@@@   @@:         +@@@             
    ;@.                     `@@@@  @@@@        @@@@@@@@@@@@@@@@@@@@@  :@@          +@@@@; ;; `.     
    ,@@@@                   @@@@@`  @' +@@'';  @@@@@@@@@@@@@@@@@@@@ ` @@;        @    @@@  '@@@     
     @@@@@@                 @@@@'  `@;    .#@; @@@@@@@@@@@@@@@@@@@    @@          @@  @@@     .     
     @@@@@@@@.             @@@@@@'    #@@`     @@@@@@@@@@@@@@@@@@@   ;   #+,    @  @@; @@@@+,       
     @@@@@@@@@@@          @@@@@@@@@,    ,@@@   @@@@@@@@@@@@@@@@@@:     :@@@@ @   @ @@@   @;    :    
     @@@@@@@@@@@@@,      `@@@@@@@@@@@      `  @@@@@@@@@@@@@@@@@@@    @@@@@@+ @@:  +@  @+   `@  #    
     @@@@@@@@@@@@@@@@    @@@@@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@`   @@@@@@@; @@@@   @   @@:    .    
     :@@@@@@@@@@@@@@@@@,    #@@@@@@@@@@@@+#@@@@@@@@@@@@@@@@@@@@@@ @@@@@@@@@  @@@@@'   @   @@  @     
      @@@@@@@@@@@@@@@@@@@@`    +@              :@@@@@@@@@@@@@@@+#@@@@@@@@@# #@@@@@@@,  .:    '@     
      @@@@@@@@@@@@@@@@@@@@@@@.       ;'+:.       :@@@@@@@@@@@'    @@@@@@@@  @@@@@@@@@@.   ` .@@     
      @@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@  @@@@@@@@@@      @@@@@@@  @@@@@@@@@@@@@'  ,@@.     
      .@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@@; +@@@@@@@@,      @@@@@@  #@@@@@@@@@@@@@@@@@@@      
       @@@@@@@@@@@@@@@@@@@@@@@@@@          ,@@@@@  @@@@@@@@,      @@@@@  @@@@@@@@@@@@@@@@@@@@@      
       @@@@@@@@@@@@@@@@@@@@@@@@@@;          @@@@@, @@@@@@@@@;    @@@@+  +@@@@@@@@@@@@@@@@@@@@`      
        @@@@@@@@@@@@@@@@@@@@@@@@@@          @@@@@# .@@@@@@@@@@;:@@@.   @@@@@@@@@@@@@@@@@@@@@@       
        @@@@@@@@@@@@@@@@@@@@@@@@@@@         @@@@@@   @@@@@@@@@@@'.  `@@@@@@@@@@@@@@@@@@@@@@@'       
        ,@@@@@@@@@@@@@@@@@@@@@@@@@@@       `@@@@@@@   ;@@@@@@@@   .@@@@@@@@@@@@@@@@@@@@@@@@@        
         @@@@@@@@@@@@@@@@@@@@@@@@@@@'      ;@@@@@@@@'   `,++.   @@@@@@@@@@@@@@@@@@@@@@@@@@@#        
         ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    @@@@@@@@@@@#       @@@@@@@@@@@@@@@@@@@@@@@@@@@@@         
          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@..@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+         
          `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@          
           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,          
            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           
            ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@            
             @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.            
              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#             
               @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@              
               `@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@               
                ,@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                
                 :@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                 
                  :@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                  
                   .@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   
                     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                    
                      @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                     
                       #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.                      
                         @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                        
                          #@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                         
                            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#                           
                              @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                             
                                @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@+                               
                                  :@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`                                 
                                     :@@@@@@@@@@@@@@@@@@@@@@@@@`                                    
                                         ,#@@@@@@@@@@@@@@@'`                                        
      */
var express = require('express');
var path = require('path');
var logger = require('morgan');
var compression = require('compression');
var methodOverride = require('method-override');
var session = require('express-session');
var flash = require('express-flash');
var bodyParser = require('body-parser');
var expressValidator = require('express-validator');
var dotenv = require('dotenv');
var exphbs = require('express-handlebars');
var mongoose = require('mongoose');
var passport = require('passport');
var recaptcha = require('express-recaptcha');
var braintree = require("braintree");
var app = express.Router();

//set the plugin controller directory
var directory = '../../../plugins/wrasse/'

// Controllers
var createController = require(directory+'controllers/create'); 
var readController = require(directory+'controllers/read');

///////////////////////////   THESE ROUTES CAN BE REMOVED FOR CUSTOM SITES   ///////////////////////////
var wrasseController = require(directory+'controllers/wrassepages'); 

///////////////////////////////////
////       COMPONENTS         //// 
/////////////////////////////////
app.get('/issues', wrasseController.issues);
 
///////////////////////////   THESE ROUTES CAN BE REMOVED FOR CUSTOM SITES   ///////////////////////////
 
 
/////////////////////////////////////////
////       CREATE CONTROLLERS       //// 
///////////////////////////////////////
app.post('/issues/createform', createController.create);
 

/////////////////////////////////////////
////       READ CONTROLLERS         //// 
///////////////////////////////////////
app.get('/issues/getprimer',   readController.getprimer);//get the primer form.
app.get('/issues/getraw',   readController.getraw);//get the raw form.
app.get('/issues/jstree', readController.jstree);//get jstree 
app.get('/issues/templateload', readController.templateload);//Load Template
app.get('/issues/templatename', readController.templatename);//get the select templatename
app.get('/issues/getdatacomp', readController.getdatacomp);//get data by array of ids.
app.get('/issues/getform',  readController.getform);//search for the form to load.
app.get('/issues/groups', readController.groups);//get the select groups

//last line
module.exports = app;